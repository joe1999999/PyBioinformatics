""" 
Given: A collection of DNA strings in FASTA format having total length at most 10 kbp.

Return: The adjacency list corresponding to O3.

You may return edges in any order.



Sample Dataset

>Rosalind_0498
AAATAAA
>Rosalind_2391
AAATTTT
>Rosalind_2323
TTTTCCC
>Rosalind_0442
AAATCCC
>Rosalind_5013
GGGTGGG


Sample Output

Rosalind_0498 Rosalind_2391
Rosalind_0498 Rosalind_0442
Rosalind_2391 Rosalind_2323

"""




def parse_fasta(data):
    """Parses FASTA formatted data into a dictionary of {label: sequence}."""
    sequences = {}
    label = None
    for line in data.strip().splitlines():
        if line.startswith(">"):
            label = line[1:]  # Extract label
            sequences[label] = ""
        else:
            sequences[label] += line.strip()  # Append sequence
    return sequences

def overlap_graph(sequences, k=3):
    """Generates the adjacency list for the overlap graph O_k."""
    adjacency_list = []
    labels = list(sequences.keys())
    
    for i, s_label in enumerate(labels):
        s_seq = sequences[s_label]
        s_suffix = s_seq[-k:]  # Get suffix of length k
        
        for j, t_label in enumerate(labels):
            if i != j:  # Ensure s != t
                t_seq = sequences[t_label]
                t_prefix = t_seq[:k]  # Get prefix of length k
                
                if s_suffix == t_prefix:  # Check for overlap
                    adjacency_list.append((s_label, t_label))
    
    return adjacency_list

# Example usage:
data = """
>Rosalind_7630
GTTATAGCGCATGTTATCCTGTGATTGAGCGTTCCCGTGTACCCACTTGGTATCCCCCCT
TGGGATCAAGCAGATCACCAATGCCTCCGGAG
>Rosalind_5149
TCCCCACGCTCTCTGACTGGATAGGCCGCAATCGGGTTGCTCGTTTCAGGGCTCACATAT
ATCCACTCCACACGCAGAGCCCCCCTGAGTTGGAG
>Rosalind_2225
CCAGAACATTCCTCCTCCCTTCTTGTTTTCCTTCGCTCACAGCGTCCGACGCGAGTTGAT
GCGGGGGCGACAGAGGAGGTACTTCAAG
>Rosalind_5652
TACGAGCCGATAGTGTGTTATAGAGGCAGGGATCTCAACTTCGCATCCCTCGATAGATTC
CCCCGGATGCATCTGTCCTACAC
>Rosalind_4053
AAGTGAATTGGATCCTGTGTAAAATATTCGAGGTCGGAGAACTATTCCGTATAACCGTCC
CCGTATAAAATAGACCCTCCTGAGTGACACGAGCTGTCT
>Rosalind_2509
ACCCATGGGACCCTTAAAGAAAAATCGTAGCGAAGACTTCGGCCTTATTATATTCGAAGT
TACCACACCTCGAGGCTTGTTAGGAACT
>Rosalind_0942
AATTTCGAGCACCTGGGTTAAGGTGCGGGTGCTCGTACTCTCAGTGCTGTTACTAAGGGA
GATTGGAGGACAAACAGAATGATGCCAT
>Rosalind_9414
TACATTGTGGAAGTCTACATAACCGGTCTTGAGACTTTCTATTGGGCCCAAAAGTAGTGC
CGATCGTGGGGTGTATCGACTTAACGTCTGATACCTCTGG
>Rosalind_7852
TGCTGCCTCATGCGATGGGTGGGTGGAATCCAGAAAATGGGAACGCCACAATGACACAAT
CAATCCCGTTATTAGCGTAGCGTATCAAATACTTACGGG
>Rosalind_8469
ATGTGGAAGTTCATACCGGACCACGTCCCGTGGTTGCTTGTGCGAGCTCATCGACATCGT
ACAACCTACGAACTGGTTGAGATCTTGTGCGACGCAGG
>Rosalind_6217
TGAGAACGCTCATACGTTAGCCTATAAAGTGCGGTACTTGACCTTGGCCGATGGACTCGC
TGACGTTCTAATCACATTACGTGCCCGTCGCGGAA
>Rosalind_9878
GTATAACAAACATCTAAAGATTAATGATTCCCCTGGCGATGGCGCCACGCCGTTTGGATC
ATTAGTTATAGAAAGCAGCAAAGGGCTGCTATTTTG
>Rosalind_6602
TTTGAACCGCCTTAGATACAATTCTGCCACGGTGCCTAAACGCAGATGCATAACCAGCCA
TTACAGTAGATACTGCGGCTATCTATCAGTATATGGTAC
>Rosalind_4746
TCTTACAACCAGATGATTCAATTGGGTCGGCGCCTAGGAGTGCGTTCTCTTATTACTACG
ATGGAGGCTAGCAGATACCTGGTTG
>Rosalind_8203
AAACCGCAGTAAATCCTCGGTCGGCTAGCGAAAGTTAGGCTGCCACACTCGCGCGTTGAG
CAAGCCTAATGGTGACTATATTTGCGCTA
>Rosalind_4677
CCATGAGCGTGCCCAAACCTCACTTTCTTTCCCATAGGTTGATTTACGTTAGACGGCCAG
GGCCGTTTAATTGTGATGCTTTGTGCC
>Rosalind_5397
GTCCGACCGTTACTATTGGGGCCCTTCTCCGGTACTGCCATATCAGGCATAGAGGATCAC
TCAAATCCCTGTGATCGGATATCCG
>Rosalind_8036
GAGGCGGGGCCCCATTGCGGAATGGCATTCTCCTAATGCATTTCTCCACTATTTGGGTTT
ATATGTCGAACAGTCCCTGTGCCCCTGCGCGTGCAAGGAC
>Rosalind_0517
ACCGGTGGATGGGCTGGCTCCCCGGCTTTTCACACACACCATCGGAGACATCACCCGGTA
TCACGGAGGGATTATGTAAC
>Rosalind_4611
CCCCCGATACGTGGAATCCTCAAAATCGCCAGCACCGAGCATTAATAACGTCATCCCCCA
CAGCAACATCGAGTACCCGAACGGTG
>Rosalind_7637
ACTTTCCAACCTGCCTAAAACTAACACGCATCCGTCTCTTAGCTGCAGGTTGCTGAAAAT
GGGCGCATCAAGCCCTCCTAAACAGTTGGACGTGT
>Rosalind_9155
GCACGCAAGATATTGGATGGGCGAGAAGAGAACTCTCCGCTTGTGTAGAGATTCCATGTA
TGGGTTAAGGAGCGGACCGC
>Rosalind_8355
TGGACGTTCACACGCTATCGCGGGTATAAACAGTCAGCGTAAGCCGGGCCATGCCGAAAT
CTGAAAGCTGATGTCTCATGGAGGATCCTCCGCACACA
>Rosalind_5463
CAGGCGCCGCATTGGCACGGTGTGTAGAATCTGGCCACCTAATGTCAGAAGTCGGCTGTG
TTGCTCCATTCACATCCATCGTGGG
>Rosalind_9103
GAACAAGCCTAAGACGCATCCTTGCCCTTCTGGTGAGTCCAGACTGGATACAGTAGCTCC
ACGGTTGAGAGAGCCCGCGGTAAACATCACCCATTA
>Rosalind_7262
TTCAACAATTCAGGGGCAGAACATTCCTATGCCCCCCCGACCGAAGATTTATTATTCATC
TGTCCGGGATGCAACTCTCACCATTATAG
>Rosalind_0031
GATCGGCAAGCCAGAAATCTTTGGGGTGGTAACGCGACATCAGAAGCAAGCGCTCCTGTG
TACTCGCAGCCTAGCGCTCATCCAGCGCGT
>Rosalind_9481
AAGGATCCTCAAATACTCTTTGAATGGTTCTAGAAAGCGGCAATCGGGCACTACCGCTAA
AGGTAAGTAATATCACCGCTCAGTAAACACGGGC
>Rosalind_0629
CACAAAGTGATCGCCGCCACTACGTCTCGACAAGACTCTGAACGGACATTCCACTAGTCA
TAAGAAACACTGCGGCTCTAACCAAACCCTGAGCGTG
>Rosalind_2248
ACCAGGATGTGGCTATCTGCACTAGGTGAGGGGTCCAACGGCGCCGCTCGCATGGCTGCC
TTATTTCGATCCTACCCCTAGTACTTGCCTATA
>Rosalind_3641
AACCTCCATATATGTTGGACCCTTTTTGGTCAGCTTGGCGCCTCATTAGTGGCCATGCAC
GAGTAGACATTCGACTTGATGAGGGATG
>Rosalind_4708
GACTGGAACTATCTCCACCTCATGTAATCGCAGTTGGCCACCTCAACTTCTCGTTCTCTC
ACGCGGTCACACCCGTTAATCCCATTG
>Rosalind_3939
GGTTGTGTCTGCACTTATTAAGTTTCCCTCTTCAGGTCCACTCATAAGGCTCCGGGACAT
AGAGTCCGAACCACAGAGAAATTACACTCTC
>Rosalind_3539
ATCAGTCTTGTAGCCCTCGGCATAGATTGATAACGAGTTGCCGGTACGGTAGGAGCGCTG
TACGTGGAATGAGGCCAGTTCGATTTCGTAAAGAGCT
>Rosalind_4776
ACCTCTAGAGATGACGTTAGGTGTACGCTATTAGGTTAGCTCCGTTAGCACCGAGATAGG
ACCCCCCATATTCTATTTTATTTTGGTTACGCCCT
>Rosalind_3135
AAGTTATAACGATTCTACGTGGCTCGGATAACCTCTCTCCGGACCTTGTAGTTACTTACC
ATGGGCACCCCAGTTTCTCATGTAGTAGCGGAGTCTATAC
>Rosalind_2551
ATCCATCAGGACATCTTGCAATATGTCGACAGGCTACTGTTAATATATATGGACACTAGA
CTCGCTTTACCGGTCCTTACAATTGACGCAGAATAGGCAC
>Rosalind_0568
CCCCGAATCGCTTCCATTGCGCAAGTAGCACGCCTTAAGAAATGTAGCCCGGGAAATGTG
TGCCCCAGCGTATTTAAGGCACGTGAC
>Rosalind_4839
ACACCCTTTTTAAACAGATCAGGCCAGGTTAACGCAAGCAAATCTGAAAACCCAATTAGC
CGAACAAGCGTAAATTTCAATCCAGGCGATAGC
>Rosalind_2847
CAAATAGCGAAAAGATTGGGCGGAAATGTCAAGAGTCCCGGAGAGCTTGTATTCGTCGTT
AATCACGATCTTAAATGACCTTCCGAC
>Rosalind_6168
TTATTCACAGAATCATCACGTCACAGTTGTAAAGATAGATTAGGCTGTACTCATGGTCAA
TTGGGCTAACCGCAAATAAGGCAACTTTAGGTAAATGA
>Rosalind_9589
TGTTCCGCGCTTATGGCGAATACGACGTGGACTCTCCAATCGAAGCTCGGGACTGGAGCA
ATTGGACTGATACGCGAACGCGACTTTACCACC
>Rosalind_1207
TAGTGGGGTAGTCAGTTTTTCCTCATATTCTACGACCCAAGCGTTTGGACCCGCGCCCGG
TGCCGGTCTAGAAGCGGATGAG
>Rosalind_8173
CTGTAGGTGAATTACTCGGCAAGAGACGAGAGCTCTATTCGATTAAGTAGCTGACCCGTA
CGTGGCATGTTTGTGAGGTAAAGATAAAGAGT
>Rosalind_4512
TGATGTCAAGAATAATAGGCAAAATGTCTAACGTATCAGGTTTTATGTTGTGTTCTAAGA
CTAACCTATTTGACGAGTAATAACATAGTTAGCACA
>Rosalind_7124
ACGTCTATTTCAGTGCCATAATCGTCACGAGAGTCCATTTGTCTTATACGCACGGAGCCT
TTGGGGGGCATCCCATTGTCAAGCTGGTGCCGGAGA
>Rosalind_2278
TTCGCCTCGCGAATTCAAATACCCGCTATCATCCGGTGGATCAGACTGTCTCCGGGAATC
TGCAGTTGCATCGTTATTGGGTTTTTTTCAGTCGTCAAG
>Rosalind_1542
CGGCTTTGGGATGATCAGTGAGAACGCGAGTCACACAAAGTTGGTATCGGCGTACCTTGT
CTCCCCGGTGCACAAGGAATTG
>Rosalind_1179
TCGTGGTAATCCTATCCGAAGCCCACGATGAAGTACTTCGCACCCGGGGTGAAATCGGAC
GCGCCATGGAAAGTGGGACGCAACTC
>Rosalind_9068
TTTGGCTGAAAATAGGAAGGATGCGTGATAATCGGAAATTAACAGGTGTTTGAGACCGCG
ACACGAAGGAGTGCCGTTGTATATT
>Rosalind_4516
TCATCGATAGGGGCGAAACTTATCCCTCCTAGTATTGCTTGTCCTAGGACCCTTCAATTA
AGGTACTGAAGCTGCCCGAAAATTATTTAGTAGAGTGA
>Rosalind_6544
ATTACCCGTTATATGCGTTCGGTTGAGCTCGGTGTGACGTCGTTAAGGGCAAGACTGACT
AAATTCCACTGTGATTTAATCCCGCGATAAGCCGGGCTCC
>Rosalind_3147
TCAAGTGGGACCTGCACAGGGATCACCGGTTTAATGTGCTCCGTGTCGGGAGGCTAACTT
TAATAACGGAAAACCGTGAA
>Rosalind_9062
CCGTTCATCCTAAGTCTTTTCGGGCGGCCCGTTGATCCGGTCACGTCAAGCCGCGACATG
GAAGTTCTCCTGGAGTTTTGGCG
>Rosalind_7338
CCCTCAAGAGGCGGCAGAAATAGCGATGAAGATGGCCCTGATCTGTCGCTATAGATTAAG
ACCTCGCCCAGTATCGCTCCCGTGGTGAT
>Rosalind_3635
GGAATTAAGATGGGCCCCGAGTAAAGACTGACTGACAACCAGCTTTCTCGAATGTTGCGC
ATCGCGTCGTATAGGGTGTCT
>Rosalind_1433
AAAAGGGACGTTGGTAATAGTACTCGTTTCTTGAGTTGGGGCCAGGCCACAATAGGTGCT
GCGTCTATCGTTATCCCGTA
>Rosalind_6960
TCCGGCGCTCTTAAGAACCTCCCCCCTTACCCTGGCCTCTGCGGTGACAGCTGATCCAAT
GCACTGGGTTCACAAAGGTCTCTGTACGCGGTCGTCCT
>Rosalind_0676
GCAAGGAGAGGCAGATATTAGCCGGCCAACCCCCCTGATGACCACAGGAATTATTATGCG
TGGACGGTTTAAATGCGGGAAATGGACGGGGTAATTA
>Rosalind_7340
CAGCATTCCTATTCTGATACGCTGCACAATCGACATTGACGGGGATGCCCCTAATACTTG
GAGGTGACTAGGGACATCCAGGC
>Rosalind_7386
GTTCGCGTAAACATACACCCCCACTTTATAGAGTCCGATCCCACTCACCTTAGAATACTT
TTTCCATCGTTGTTACACCGTCTGTT
>Rosalind_5794
GAAACACTAGTAGCTTGACTTTACTACAGACAACCAGTCAATTAAACGGAAATTGTTTCC
GAACTGATATCGCTTTGGTACGCGCCCTAAGA
>Rosalind_8796
CGTAGACTCGCTCCGCTTAAGTGCCTAGCCCCATTAAGAAGATGAGTATGCCGTCTAACC
ACTGCTCCCGACTTTTCCGCCGTGG
>Rosalind_2692
TCGCGGAAGCACCACTCCCAAAGGGGGCAACATCTACTTATAACCGGATTCAGTAAAATC
GTGCATTGACTAAATTGTCCTCCCCGTCGACAAT
>Rosalind_2635
AAGACTCGCAATCTGCATGAGTTGGCGCGCATGAGTACGCGTTCAGCCGGTATGCGATCT
AGTTGTCTTTGAGTCTAGAAGC
>Rosalind_8439
TCACCTATCGGCACGAATAGATCCATGAGCCAGGAGAACATTATGCGTGAATTAGAGATC
CCAGTAGGGTCGTCTGTCTAGTCGCT
>Rosalind_5111
CCCTGAGGGAGAACGCATCGGGCAGGTACAACCGGAGAAGCACTATACCAATTGGGTACT
ATCCGATATGATCTGTCGGTATCGGATAGGCTGGGCT
>Rosalind_0073
TGAGCGCTGAGCGAATTAGGACGAAAGACATATTCCTTCTAGCCCTATTCAAGACTGTCC
GCCGCCGACTTGTTATATATGCAACCCGCGGCAAGT
>Rosalind_3162
AGCGACTCCGGAATGAAAGATAGTCGCTGGTTCTAGTTTTCTAATACGTACTTCTCTCCC
GCTTGCAATAATCATCAATCTAAACTC
>Rosalind_9915
AGGTCGGTCAAGGTACCCGTGGATCCATCTCCTAGCTTAGCCCAACACTATCGTCCACCA
GAATGTGACCTTATTAAGTATTAGACGAAGAGC
>Rosalind_3721
CTCAGCCTGTGGCTCGAGATTAATCTGCGACGGCTCACGTTTCAGCAGTGTGAAGAAATA
CTTACAGCTCAAACTTATTGGT
>Rosalind_4832
ACGACGAGCTAACCCGCGTGGTACTCCGTTGAGCCTGCAAAGCTGATAAACGTATCTTTG
ACTAAACCTGGATGTAAAGCACACGATTTA
>Rosalind_2111
ACACAGATAAGATGTTTAAAGGAACTCGGCTCAGCAGGATTATACAATCCTCTAGAATCG
CAAAAGGGACTCCGTTTCCTTACCTC
>Rosalind_1897
TTCGATCGGAAAGTCTCTGAATGGTGACTTGAGGCCATTCCTTACCCGGGGCGTGAGTAT
TCGCGTAATTTTTATAGTAGAATTGACGCCACT
>Rosalind_4173
ACCAGAAACATGGTGGTGTCCCTTTACGTTTCGACTGGCCGATAGTACCACGGCAGACCA
CGGTTCGATGATTCGCTACAAATCGTACATCC
>Rosalind_3680
GCCTGATTGATTAAAATTGCTTGGGGACAGGTGAATACCGAGACATACACGGAGATGACC
CCCCGTCATCCTTATGGTTCAATAGATTC
>Rosalind_4094
TATTACGACTTGCTGCTCCGCCGCGAGCTGAGCGTATAGTTAGTACCGTGGATGCAAGCT
ATGCCACCAATTACCTCTTAGCG
>Rosalind_4322
GACTTTCCCGCGTTAACATGGGGTGCTTTACGAGCGAGAGTTCAGCATTTCAACGCCCCC
AATTATCCCACTAGTGCACGGAAGTTC
>Rosalind_0100
TCCATTTCCCAGACGCCCTGAAACTAATATTCACTCTTGCAAGTGTCTTACCCCATAACT
CACCTGCCTTATGCAAAACTTTACGCTCCGCCA
>Rosalind_4344
GGGTCAGCCCACTTTATTGGTCAGATAGGCAGTGCCTTCCAGGTCGTATGAGTAAACCTT
AACCTTGCTTGGGGGCATTGTCCCACCTATGACCA
>Rosalind_1025
CGACAGTATGGTGTTATCATCCACATCCCGCTCCAAGCACATGCCCCGAGTCAGTGTGTC
CGAAACTTGGGTTTTACTACTTCCT
>Rosalind_9670
ATCTGACAGTGCGGCGGGATGCTTACGCCGACTGTGCAAGGCTGTCGAGGGGTCTTCGCA
GTCTATGCTGCCCTCGCATGT
>Rosalind_4502
AGGAGAAAGGCCACCCATCCACGGCACTTGTGCCGAACACTTGATGGGAGGGGAGTTTGC
TTAAAGCGACGGAGGGTACGCCGCGATGTAAATCGCA
>Rosalind_8938
CTTTCCCATCCGTAGCGTCCATATGTTTGTCGGAGGGACCTTACCAACCTCTCTACTCTT
ATTCATCCTCCCTGTCCTAGGTATTGAAGCATC
>Rosalind_3489
GACTAATGATTTCGCGACAAGCATGAACTCGAGAGAGAACAGTTAGTTAGTTAAACTTAC
TCTGAAGCTGAACTAGAGCTAGGGTAGGGGCATCGT
>Rosalind_4571
ATGTCATAGAGTGCACACTCCGAGTCTGGGATGGGAAAAAATTTACCCAGCGTGTAACTA
AGTCCTGTAGGGTGGAACTTT
>Rosalind_4563
CAGTATCGAAGCGTGCCAAGTTCTAACACGATTTAGTTAGCTGGCAAACGGTCACTTGCG
AAGTTGCAGAGAATTAGCAATGAGAAC
>Rosalind_3663
TAACTCATCACAACGGAATGCGTGCATGCAACGGCGCAACACGACACATTCCGGCGAACA
TCTGACAGTTCGCCAGTCCAGGGACGGCTGTTCCC
>Rosalind_8358
ACAGCCGTCCAGAAGTTAGCCTGGAACTGTGGACCTCGGGGGCATGGCGAAGAGGGAAGT
TAAGCTCGAAGGTGGTTTCTATGC
>Rosalind_3644
CCGACATCTGCGAACATGTCGCGTCCTCGATGGGTTCTGGCGCTGTGTATCAAGCGGGCG
TACGGCGACGTAGGTAATATACATGTGACGGCTTG
>Rosalind_9990
ACCGGCCGACTACCAGAAGAAGACGACGGTTATGCTTTCACTCACCTATGTAGCGATCGT
AGGATCATTGAGCTTACCTAT
>Rosalind_2977
AACCTAGAGTGCATTATACCGGTATACGACAACCTTCTGAGAGGCTATTCCAACACCCTT
TCCTAAGTTTTAGTTTGCTAAAGCAACAACCCTTGTC
>Rosalind_8797
CGCATTATGGCCCGTACGGATTAATAGAGGAGGCTCCTTTTAAAGGTACTTCGTGGCTTA
GCCAAGGCAGTCTGATGCAA
>Rosalind_3184
ATCCGGCTTCAATAATCCCGCCGGTTGAGTATACGTCCTGAGGTGATTTATCCTACGCGC
CAAATACGAAGTAGCGGTCGCA
>Rosalind_6089
GTATGCGTGATGAAGCAGGGCCGACGATCTCCCACTAAGTTTGTTAGCTGCTGGTGGTCG
GAGTGACCTATTGATAGTGACCGCTTACCAACTAGG
>Rosalind_5763
ACTACAAACCGCGAACGAGTCTAATCTACATGCACTCCGTCTTGTTATTACTGCCGAATA
CATCTTTTCAGTGCGGTAATCCTCAG
>Rosalind_3403
TGTGTGTAACCGAGGTCACACTAACGGGACAGAACTAGTGTCACAAGCATGGCGCCTGAT
CGTCGTGAGTTCGAGCATAAGGGGTAAGTCACGAGA
>Rosalind_5818
ATAGTTTTTAGCTAATGGCCACCAAGGAGCACCCCTTTTCTATGCTATGGAGCTGATCTA
TATCAGATGCGCCGGACCCA
>Rosalind_3497
TAAGCATAGGCATGAACACGGTCTTAACGACTTTGTTCACGCTCCACGTATCCCTTAATT
GATGAGTGTTTATCCCCAGCAGCA
>Rosalind_4048
GAAGACTCCAAATTTGGGGTACGTTGAGGGGCGGTTGTTGGCAGAGCATTCTCAAATAAG
CGCCGTGAGACGCTGTCCATCACGTATCATGG
"""

# Parse input and construct graph
sequences = parse_fasta(data)
adj_list = overlap_graph(sequences, k=3)

# Print adjacency list
for edge in adj_list:
    print(edge[0], edge[1])
